(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-724df3c9","chunk-4bcad545","chunk-193fffd4"],{"0857":function(t,e,a){"use strict";a("a0e0");var s=a("a013"),i=a("f425"),n=a("dad2"),r="toString",l=/./[r],o=function(t){a("e5ef")(RegExp.prototype,r,t,!0)};a("b6f1")(function(){return"/a/b"!=l.call({source:"a",flags:"b"})})?o(function(){var t=s(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?i.call(t):void 0)}):l.name!=r&&o(function(){return l.call(this)})},"119c":function(t,e,a){"use strict";var s=a("b6f1");t.exports=function(t,e){return!!t&&s(function(){e?t.call(null,function(){},1):t.call(null)})}},6009:function(t,e,a){},6768:function(t,e,a){"use strict";var s=a("6009"),i=a.n(s);i.a},a0e0:function(t,e,a){a("dad2")&&"g"!=/./g.flags&&a("ddf7").f(RegExp.prototype,"flags",{configurable:!0,get:a("f425")})},b745:function(t,e,a){"use strict";var s=a("b2f5"),i=a("648a"),n=a("db4b"),r=a("b6f1"),l=[].sort,o=[1,2,3];s(s.P+s.F*(r(function(){o.sort(void 0)})||!r(function(){o.sort(null)})||!a("119c")(l)),"Array",{sort:function(t){return void 0===t?l.call(n(this)):l.call(n(this),i(t))}})},d503:function(t,e,a){"use strict";a.r(e);var s,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:t.thisValue,callback:function(e){t.thisValue=e},expression:"thisValue"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s("add"===t.resType?"添加角色":"修改角色"))])]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{label:"角色名称*",placeholder:"输入角色名称",rules:[function(t){return!!t||"角色名称必填"}],required:""},model:{value:t.thisMsg.role_name,callback:function(e){t.$set(t.thisMsg,"role_name",e)},expression:"thisMsg.role_name"}}),a("v-text-field",{attrs:{label:"备注",placeholder:"输入备注信息"},model:{value:t.thisMsg.remarks,callback:function(e){t.$set(t.thisMsg,"remarks",e)},expression:"thisMsg.remarks"}}),a("v-text-field",{attrs:{label:"序号",placeholder:"输入序号"},model:{value:t.thisMsg.sort,callback:function(e){t.$set(t.thisMsg,"sort",e)},expression:"thisMsg.sort"}}),a("div",[a("span",[t._v("是否启用：")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#e1e1e1","inactive-value":0,"active-value":1},model:{value:t.thisMsg.status,callback:function(e){t.$set(t.thisMsg,"status",e)},expression:"thisMsg.status"}})],1)],1)],1)],1),a("v-card-actions",{staticClass:"justify-space-between"},[a("v-btn",{attrs:{color:"blue gray",text:""},on:{click:function(e){t.thisValue=!1}}},[t._v("取消")]),a("v-btn",{attrs:{color:"dark darken-1",loading:t.loading,text:""},on:{click:function(e){return t.doUpdate()}}},[t._v("保存")])],1)],1)],1)},n=[],r=(a("b745"),{props:{value:{type:Boolean,required:!0,default:!1},msg:{type:Object,required:!1,default:{role_name:"",remarks:"",sort:"",status:0}},type:{type:String,required:!0}},data:function(){return{valid:!0,resType:this.type,thisValue:this.value,thisMsg:JSON.parse(JSON.stringify(this.msg)),loading:!1}},watch:{value:function(t){this.thisValue=t},thisValue:function(t){this.$emit("change",t)},type:function(t){this.resType=t,"add"===t&&(this.thisMsg={role_name:"",remarks:"",sort:"",status:0})},msg:function(t){this.thisMsg=t}},mounted:function(){s=this},methods:{doUpdate:function(){this.$refs.form.validate()&&(this.loading=!0,this.$post("role/"+this.resType,{id:this.thisMsg.id||"",role_name:this.thisMsg.role_name,remarks:this.thisMsg.remarks,sort:this.thisMsg.sort,status:this.thisMsg.status},function(t){s.loading=!1,0==t.errno&&(s.$message({showClose:!0,message:t.errmsg,type:"success"}),s.thisValue=!1,s.$emit("changemsg",t))}))}}}),l=r,o=a("6691"),c=Object(o["a"])(l,i,n,!1,null,null,null);e["default"]=c.exports},eae5:function(t,e,a){"use strict";a.r(e);var s,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-xl":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:"",lg2:""}},[a("v-text-field",{staticClass:"pr-2",attrs:{label:"ID"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList()}},model:{value:t.query.id,callback:function(e){t.$set(t.query,"id",e)},expression:"query.id"}})],1),a("v-flex",{attrs:{md3:"",lg2:""}},[a("v-text-field",{staticClass:"pr-2",attrs:{label:"角色名称"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList()}},model:{value:t.query.role_name,callback:function(e){t.$set(t.query,"role_name",e)},expression:"query.role_name"}})],1),a("v-flex",{attrs:{md3:"",lg2:""}},[a("v-text-field",{staticClass:"pr-2",attrs:{label:"备注"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList()}},model:{value:t.query.remarks,callback:function(e){t.$set(t.query,"remarks",e)},expression:"query.remarks"}})],1),a("v-flex",{attrs:{md3:"",lg2:""}},[a("v-select",{attrs:{items:[{label:"全部",value:""},{label:"启用",value:1},{label:"禁用",value:0}],label:"状态","item-text":"label","item-value":"value"},on:{change:function(e){return t.getList()}},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}})],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{"xs-12":"","md-12":"","lg-12":"","sm-12":""}},[a("v-btn",{attrs:{color:"gray"},on:{click:function(e){return t.resetSearch()}}},[t._v("重置")]),a("v-btn",{attrs:{color:"dark"},on:{click:function(e){return t.getList()}}},[a("v-icon",{attrs:{size:"14"}},[t._v("mdi-account-search")]),t._v(" 搜索\n      ")],1)],1)],1),a("v-divider"),a("v-layout",{attrs:{wrap:"","justify-space-between":""}},[a("v-flex",{attrs:{sm8:"",xs12:"",md8:"",lg8:""}},[a("v-btn",{attrs:{color:"danger"},on:{click:function(e){return t.recover()}}},[t._v("删除")]),a("v-btn",{attrs:{color:"success"},on:{click:function(e){return t.statusChange(1)}}},[t._v("启用角色")]),a("v-btn",{attrs:{color:"warning"},on:{click:function(e){return t.statusChange(0)}}},[t._v("禁用角色")]),a("v-btn",{attrs:{color:"dark"},on:{click:function(e){t.roleEditType="add",t.dialog=!0}}},[t._v("添加角色")]),a("v-btn",{staticClass:"inline-block",attrs:{color:"gray",icon:""},on:{click:function(e){return t.getList()}}},[a("v-icon",[t._v("mdi-autorenew")])],1)],1),a("div",[a("v-select",{staticClass:"pr-2 inline-block",attrs:{items:t.pageSizes,"item-text":"label","item-value":"value",label:"每页条数",required:""},on:{change:function(e){return t.getList()}},model:{value:t.query.pageSize,callback:function(e){t.$set(t.query,"pageSize",e)},expression:"query.pageSize"}})],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{"xs-12":"","md-12":"","lg-12":"","sm-12":""}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoad,expression:"tableLoad"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.items,"tooltip-effect":"dark",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"序号",prop:"sort",width:"60"}}),a("el-table-column",{attrs:{label:"角色名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.id)+":"+t._s(e.row.role_name||"-- -- --"))])]}}])}),a("el-table-column",{attrs:{label:"备注"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.remarks||"-- -- --"))])]}}])}),a("el-table-column",{attrs:{prop:"",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[1==e.row.status?a("v-chip",{staticClass:"ma-2",attrs:{"text-color":"white",color:"green",small:""}},[t._v("启用")]):t._e(),0==e.row.status?a("v-chip",{staticClass:"ma-2",attrs:{"text-color":"white",color:"warning",small:""}},[t._v("禁用")]):t._e()],1)]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("v-btn",{attrs:{color:"dark",dark:"",small:""},on:{click:function(a){t.dialog=!0,t.roleEditType="update",t.tempData=e.row}}},[t._v("修改")]),a("v-btn",{attrs:{color:"dark",dark:"",small:""},on:{click:function(a){t.dialog2=!0,t.tempData=e.row}}},[t._v("权限")])],1)]}}])})],1)],1)],1),a("v-layout",{attrs:{wrap:"","justify-end":"","mt-3":""}},[a("el-pagination",{attrs:{"current-page":t.query.currentPage,"page-size":t.query.pageSize,layout:"total,  prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),a("role-edit",{attrs:{msg:t.tempData,type:t.roleEditType},on:{change:t.updateMsgChange,changemsg:t.changeMsg},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}}),a("authority",{attrs:{user:t.tempData},on:{change:t.authorityChange,changemsg:t.changeMsg},model:{value:t.dialog2,callback:function(e){t.dialog2=e},expression:"dialog2"}})],1)},n=[],r=(a("0857"),a("d503")),l=a("efb5"),o={props:{load:{type:Boolean,default:!1}},watch:{load:function(t){t&&(this.pageLoad=t)},pageLoad:function(t){t&&this.getList()}},components:{roleEdit:r["default"],Authority:l["default"]},data:function(){return{pageLoad:!1,roleEditType:"add",items:[],query:{role_name:"",remarks:"",status:"",id:"",sorts:"sort asc",currentPage:1,pageSize:10},multipleSelection:[],pageSizes:this.$pageSizes,tableLoad:!1,total:0,dialog:!1,dialog2:!1,tempData:{}}},mounted:function(){s=this},methods:{getList:function(){this.tableLoad=!0,this.$post("role/list",this.query,function(t){s.tableLoad=!1,0===t.errno&&(s.items=t.data.data,s.total=t.data.count)})},resetSearch:function(){this.query.id="",this.query.role_name="",this.query.remarks="",this.query.status="",this.getList()},handleSelectionChange:function(t){this.multipleSelection=t},getIds:function(){var t=[];for(var e in this.multipleSelection)t.push(this.multipleSelection[e].id);return t},handleCurrentChange:function(t){this.query.currentPage=t,this.getList()},statusChange:function(t){this.$checkSelect(this.multipleSelection)&&this.$post("role/status",{ids:this.getIds().toString(),status:t},function(t){0==t.errno&&(s.$message({showClose:!0,message:t.errmsg,type:"success"}),s.getList())})},recover:function(){var t=this;this.$checkSelect(this.multipleSelection)&&this.$confirm("删除否此数据将无效，可在回收站恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$post("role/recover",{ids:t.getIds().toString()},function(t){0==t.errno&&(s.$message({showClose:!0,message:t.errmsg,type:"success"}),s.getList())})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},updateMsgChange:function(t){this.dialog=t},authorityChange:function(t){this.dialog2=t},changeMsg:function(t){this.getList()}}},c=o,u=a("6691"),d=Object(u["a"])(c,i,n,!1,null,null,null);e["default"]=d.exports},efb5:function(t,e,a){"use strict";a.r(e);var s,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"","max-width":"800px","min-height":"500px"},model:{value:t.thisValue,callback:function(e){t.thisValue=e},expression:"thisValue"}},[a("v-card",[a("v-toolbar",{attrs:{id:"core-toolbar",color:"dark",prominent:""}},[a("div",{staticClass:"v-toolbar-title"},[a("v-toolbar-title",{staticClass:"white--text font-weight-light"},[t._v(t._s(t.thisUser.role_name)+"的权限")])],1),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){t.thisValue=!1}}},[a("v-icon",[t._v("el-icon-close")])],1)],1)],1),a("v-layout",{attrs:{"justify-center":"","align-center":""}},[a("v-flex",{attrs:{xs6:"",md6:"",lg6:"",sm6:""}},[a("v-card-text",[a("v-treeview",{attrs:{items:t.items,"selected-color":"green","open-on-click":"",selectable:"","return-object":""},model:{value:t.selection,callback:function(e){t.selection=e},expression:"selection"}})],1)],1),a("v-divider",{attrs:{vertical:""}}),a("v-flex",{attrs:{xs12:"",md6:"",lg6:"",sm12:""}},[a("v-card-text",[0===t.selection.length?a("div",{key:"title",staticClass:"title font-weight-light grey--text pa-4 text-center"},[t._v("为"+t._s(t.thisUser.role_name)+"添加一些权限")]):t._e(),a("v-scroll-x-transition",{attrs:{group:"","hide-on-leave":""}},t._l(t.selection,function(e,s){return a("v-chip",{key:s,staticClass:"ma-1",attrs:{color:"grey",dark:"",small:""}},[a("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-beer")]),t._v("\n              "+t._s(e.name)+"\n            ")],1)}),1)],1)],1)],1),a("v-divider"),a("v-card-actions",{staticClass:"justify-space-between"},[a("v-btn",{attrs:{color:"gray darken-1"},on:{click:function(e){t.selection=[]}}},[t._v("清空权限")]),a("v-btn",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"white--text",attrs:{color:"dark darken-1",depressed:""},on:{click:t.submit}},[t._v("\n        保存\n      ")])],1)],1)],1)},n=[],r=(a("0857"),{props:{value:{type:Boolean,required:!0,default:!1},user:{type:Object,required:!0,default:{id:"",role_name:"XX"}}},data:function(){return{thisValue:this.value,loading:!1,thisUser:this.user,auth:[],isLoading:!1,selection:[],items:[],selData:[]}},watch:{value:function(t){this.thisValue=t},thisValue:function(t){this.$emit("change",t)},user:function(t){this.thisUser=t,this.getAuth(),this.getOwnData()}},mounted:function(){s=this},methods:{getAuth:function(){this.$post("authority/list",{},function(t){if(0==t.errno){s.auth=t.data;var e=[];for(var a in t.data)for(var i in e.push({id:t.data[a].id+"_",name:t.data[a].cate_name,children:[]}),t.data[a].authority)e[a].children.push({id:t.data[a].authority[i].id,name:t.data[a].authority[i].auth_name});s.items=[{id:"q1",name:"全部权限",children:e}]}})},getOwnData:function(){this.$post("authority/own",{role_id:this.thisUser.id},function(t){0===t.errno&&(s.selData=JSON.parse(JSON.stringify(t.data)),s.selection=JSON.parse(JSON.stringify(t.data)))})},filterNewAuth:function(){if(this.selection.length>this.selData.length){var t=[];for(var e in this.selection){var a=-1;for(var s in this.selData)this.selection[e].id==this.selData[s].id&&(a=s);-1==a&&"number"==typeof this.selection[e].id&&t.push({auth_id:this.selection[e].id,role_id:this.thisUser.id})}return t.length>0&&{arr:t,type:"give"}}if(this.selection.length<this.selData.length){var i=[];for(var n in this.selData){var r=-1;for(var l in this.selection)this.selection[l].id==this.selData[n].id&&(r=l);-1==r&&"number"==typeof this.selection[n].id&&i.push(this.selection[n].id)}return i.length>0&&{arr:i,type:"del"}}return!1},submit:function(){var t=this.filterNewAuth();t&&(this.loading=!0,this.$post("authority/"+t.type,{array:"del"==t.type?t.arr.toString():JSON.stringify(t.arr),role_id:this.thisUser.id},function(t){s.loading=!1,0==t.errno&&(s.$message({showClose:!0,message:t.errmsg,type:"success"}),s.thisValue=!1,s.$emit("changemsg",t))}))}}}),l=r,o=(a("6768"),a("6691")),c=Object(o["a"])(l,i,n,!1,null,null,null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-724df3c9.16db6740.js.map